create_map("category_id", 101, "class_id", 101000, "detection_start_time", timestamp, 
  "detection_end_time", timestamp, "device_entities", [create_map("uid", ucast(map_get(input_event, "dest_device_id"), "string", null), "type_id", 0)], 
  "disposition_id", 1, "end_time", timestamp, "event_id", 10100001, "event_time", strftime(timestamp, "%Y-%m-%dT%H:%M:%S.%6QZ", "%Z"), 
  "finding", create_map("confidence", {{ detection.tags.confidence }}, "confidence_id", {{ detection.tags.confidence_id }}, 
  "context_ids", {{ detection.tags.context_ids }}, "impact", {{ detection.tags.impact }}, "impact_id", {{ detection.tags.impact_id }},
  "kill_chain_phase", "{{ detection.tags.kill_chain_phases[0] }}", "kill_chain_phase_id", {{ detection.tags.kill_chain_phases_id[0] }}, 
  "risk_level", "{{ detection.tags.risk_level }}", "risk_level_id", {{ detection.tags.risk_level_id }}, "risk_score", {{ detection.tags.risk_score }}, 
  "type_id", 1, "ref_event_uid", event_id), "message", "{{ detection.tags.message }}", 
  "metadata", create_map("log_name", "{{ detection.datamodel[0] }}", "version", "1.0.0"), 
  "observables", {{ detection.tags.observable_str }}, 
  "origin", create_map("product", create_map("name", "Splunk Behavioral Analytics")), 
  "rule", create_map("name", "{{ detection.name }}"), "start_time", timestamp, "time", timestamp,
  "user_entities", [create_map("uid", ucast(map_get(input_event, "dest_user_id"),"string", null))])